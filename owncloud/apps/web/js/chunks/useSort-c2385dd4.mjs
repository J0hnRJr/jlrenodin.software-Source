var b=Object.defineProperty;var h=(e,r,u)=>r in e?b(e,r,{enumerable:!0,configurable:!0,writable:!0,value:u}):e[r]=u;var y=(e,r,u)=>(h(e,typeof r!="symbol"?r+"":r,u),u);import{E as d,K as t,D as g,G as D,aV as S}from"./vendor-2c44cb30.mjs";import{b as I,c as A}from"./useAuthService-746ac4ed.mjs";import{a5 as F}from"./useDriveResolver-f387970c.mjs";import"./eventBus-bf81ca73.mjs";const V=()=>{const e=I();return d(()=>t(e).name)},j=(e,r=void 0)=>{const u=window.localStorage.getItem(e),a=g(r);if(u)try{a.value=JSON.parse(u)}catch{a.value=u}return D(()=>t(a),(o,n)=>{o!==n&&(o!==void 0?window.localStorage.setItem(e,typeof o=="string"?o:JSON.stringify(o)):window.localStorage.removeItem(e))},{deep:!0}),a},R=e=>{const r=F(e.name),u=j(q(e));return D(()=>t(r)?{value:t(r),source:"route"}:t(u)?{value:t(u),source:"storage"}:{value:e.defaultValue,source:"default"},a=>{["route","default"].includes(a.source)&&(u.value=a.value===e.defaultValue?void 0:a.value),["storage","default"].includes(a.source)&&(r.value=a.value)},{immediate:!0}),r},q=e=>["oc_options",e.routeName,e.name].filter(Boolean).join("_");class m{}y(m,"sortByQueryName","sort-by"),y(m,"sortDirQueryName","sort-dir");var x=(e=>(e.Desc="desc",e.Asc="asc",e))(x||{});function z(e){const r=A(),u=J(e),a=K(e),o=d(()=>{var s;return w(t(u))||t((s=Q(t(c)))==null?void 0:s.name)}),n=d(()=>C(t(a))||O(t(o),t(c))),c=e.fields;return{items:d(()=>{const s=t(e.items);return t(o)?_(s,t(c),t(o),t(n)):s}),sortBy:o,sortDir:n,handleSort:({sortBy:s,sortDir:f})=>r.replace({query:{...t(r.currentRoute).query,[t(e.sortByQueryName)||m.sortByQueryName]:s,[t(e.sortDirQueryName)||m.sortDirQueryName]:f}})}}function J(e){var r;return e.sortBy?S(e.sortBy)?e.sortBy:g(e.sortBy):R({name:t(e.sortByQueryName)||m.sortByQueryName,defaultValue:t((r=Q(t(e.fields)))==null?void 0:r.name),routeName:t(e.routeName)||t(V())})}function K(e){var r;return e.sortDir?S(e.sortDir)?e.sortDir:g(e.sortDir):R({name:t(e.sortDirQueryName)||m.sortDirQueryName,defaultValue:t((r=Q(t(e.fields)))==null?void 0:r.sortDir),routeName:t(e.routeName)||t(V())})}const Q=e=>{const r=e.filter(u=>u.sortable);return r?r[0]:null},O=(e,r)=>{const u=r.find(a=>a.name===e);return u&&u.sortDir?t(u.sortDir):"desc"},_=(e,r,u,a)=>{const o=r.find(i=>i.name===u);if(!o)return e;const{sortable:n}=o,c=new Intl.Collator(navigator.language,{sensitivity:"base",numeric:!0});if(u==="name"){const i=[...e.filter(s=>s.type==="folder")].sort((s,f)=>N(s,f,c,u,a,n)),l=[...e.filter(s=>s.type!=="folder")].sort((s,f)=>N(s,f,c,u,a,n));return a==="asc"?i.concat(l):l.concat(i)}return[...e].sort((i,l)=>N(i,l,c,u,a,n))},N=(e,r,u,a,o,n)=>{let c=e[a],i=r[a];const l=o==="asc"?1:-1;if(n)if(typeof n=="string"){const f=B=>B.map(v=>v[n]).join("");c=f(c),i=f(i)}else typeof n=="function"&&(c=n(c),i=n(i));return!isNaN(c)&&!isNaN(i)?(c-i)*l:u.compare((c||"").toString(),(i||"").toString())*l},w=e=>Array.isArray(e)?e[0]:e,C=e=>{switch(w(e)){case"asc":return"asc";case"desc":return"desc"}return null};export{m as S,x as a,V as b,R as c,z as d,_ as s,j as u};
