import{d as x,C as j,E as I,g as f,h as V,o,c as w,j as v,w as b,a as m,b as g,f as h,e as u,t as $,k as P,n as T,$ as B,D as R,K as t,W as q,ac as E}from"./chunks/vendor-2c44cb30.mjs";import{a as O}from"./chunks/useAppDefaults-324f07ea.mjs";import{c as H,b as W}from"./chunks/useAuthService-746ac4ed.mjs";import{_ as z}from"./chunks/eventBus-bf81ca73.mjs";import{a5 as K,t as U,a7 as G}from"./chunks/useDriveResolver-f387970c.mjs";import{s as Q}from"./chunks/useSort-c2385dd4.mjs";import{A as J}from"./chunks/AppTopBar-d00b7bc4.mjs";import{u as X}from"./chunks/useDownloadFile-992d548e.mjs";import"./chunks/useStore-acb4016c.mjs";const Y={},ee={"%{ displayIndex } of %{ availableMediaFiles }":"%{ displayIndex } от %{ availableMediaFiles }","Download currently viewed file":"Изтегляне на разглеждания в момента файл","Enlarge the image":"Увеличаване на изображението","Enter full screen mode":"Преминаване в режим на цял екран","Exit full screen mode":"Излизане от режим на цял екран","Failed to load media file":"Неуспешно зареждане на медийния файл","Loading media file":"Зареждане на медиен файл","Media file %{ displayIndex } of %{ availableMediaFiles }":"Медиен файл %{ displayIndex } от %{ availableMediaFiles }",Preview:"Преглед","Preview for %{currentMediumName}":"Предварителен преглед на %{currentMediumName}","Rotate the image 90 degrees to the left":"Завъртане на изображението на 90 градуса наляво","Rotate the image 90 degrees to the right":"Завъртане на изображението на 90 градуса надясно","Show next media file in folder":"Показване на следващия медиен файл в папката","Show previous media file in folder":"Показване на предишния медиен файл в папката","Show the image at its normal size":"Показване на изображението в нормален размер","Shrink the image":"Свиване на изображението"},ie={"%{ displayIndex } of %{ availableMediaFiles }":"%{ displayIndex } z %{ availableMediaFiles }","Download currently viewed file":"Stáhnout právě prohlížený soubor","Enlarge the image":"Zvětšit obrázek","Enter full screen mode":"Spustit režim celé obrazovky","Exit full screen mode":"Opustit režim celé obrazovky","Failed to load media file":"Nezdařilo se nahrávání multimediálního souboru","Loading media file":"Nahrávání multimediálního souboru","Media file %{ displayIndex } of %{ availableMediaFiles }":"Mediální soubor %{ displayIndex } z %{ availableMediaFiles }",Preview:"Náhled","Preview for %{currentMediumName}":"Náhled %{currentMediumName}","Rotate the image 90 degrees to the left":"Otočit obrázek o 90 stupňů doleva","Rotate the image 90 degrees to the right":"Otočit obrázek o 90 stupňů doprava","Show next media file in folder":"Zobrazit další mediální soubor ve složce","Show previous media file in folder":"Zobrazit předchozí mediální soubor ve složce","Show the image at its normal size":"Ukázat obrázek v jeho normální velikosti","Shrink the image":"Zmenšit obrázek"},ae={"%{ displayIndex } of %{ availableMediaFiles }":"%{ displayIndex } von %{ availableMediaFiles }","Download currently viewed file":"Aktuell betrachtete Datei herunterladen","Enlarge the image":"Das Bild vergrößern","Enter full screen mode":"Vollbildmodus aufrufen","Exit full screen mode":"Vollbildmodus verlassen","Failed to load media file":"Fehler beim Laden der Mediendatei","Loading media file":"Lade Mediendatei","Media file %{ displayIndex } of %{ availableMediaFiles }":"Mediendatei %{ displayIndex } von %{ availableMediaFiles }",Preview:"Vorschau","Preview for %{currentMediumName}":"Vorschau für %{currentMediumName}","Rotate the image 90 degrees to the left":"Das Bild um um 90 Grad nach links drehen","Rotate the image 90 degrees to the right":"Das Bild um um 90 Grad nach rechts drehen","Show next media file in folder":"Nächste Mediendatei im Order anzeigen","Show previous media file in folder":"Vorherige Mediendatei im Order anzeigen","Show the image at its normal size":"Das Bild in seiner normalen Größe anzeigen","Shrink the image":"Das Bild verkleinern"},te={},oe={"%{ displayIndex } of %{ availableMediaFiles }":"%{ displayIndex } de %{ availableMediaFiles }","Download currently viewed file":"Télécharger le fichier affiché","Failed to load media file":"Impossible de charger le fichier média","Loading media file":"Chargement du fichier média","Media file %{ displayIndex } of %{ availableMediaFiles }":"Fichier média %{ displayIndex } de %{ availableMediaFiles }",Preview:"Prévisualisation","Preview for %{currentMediumName}":"Prévisualisation de %{currentMediumName}","Show next media file in folder":"Afficher le fichier média suivant","Show previous media file in folder":"Afficher le fichier média précédent"},ne={},re={"%{ displayIndex } of %{ availableMediaFiles }":"%{ displayIndex } מתוך %{ availableMediaFiles }","Download currently viewed file":"הורדת הקובץ שנצפה כעת","Enlarge the image":"הגדלת התמונה","Enter full screen mode":"כניסה למסך מלא","Exit full screen mode":"יציאה ממסך מלא","Failed to load media file":"טעינת קובץ המדיה נכשלה","Loading media file":"קובץ מדיה נטען","Media file %{ displayIndex } of %{ availableMediaFiles }":"קובץ מדיה %{ displayIndex } מתוך %{ availableMediaFiles }",Preview:"תצוגה מקדימה","Preview for %{currentMediumName}":"תצוגה מקדימה של %{currentMediumName}","Rotate the image 90 degrees to the left":"היפוך התמונה ב־90 מעלות לשמאל","Rotate the image 90 degrees to the right":"היפוך התמונה ב־90 מעלות לימין","Show next media file in folder":"הצגת קובץ המדיה הבא בתיקייה","Show previous media file in folder":"הצגת קובץ המדיה הקודם בתיקייה","Show the image at its normal size":"להציג את התמונה בגודלה המקורי","Shrink the image":"כיווץ התמונה"},le={},se={"%{ displayIndex } of %{ availableMediaFiles }":"%{ displayIndex } z %{ availableMediaFiles }","Download currently viewed file":"Pobierz ten plik","Enlarge the image":"Powiększ obraz","Enter full screen mode":"Włącz tryb pełnoekranowy","Exit full screen mode":"Wyjdź z trybu pełnoekranowego","Failed to load media file":"Błąd ładowania pliku","Loading media file":"Otwieranie pliku","Media file %{ displayIndex } of %{ availableMediaFiles }":"Plik %{ displayIndex } z %{ availableMediaFiles }",Preview:"Podgląd","Preview for %{currentMediumName}":"Podgląd dla %{currentMediumName}","Rotate the image 90 degrees to the left":"Obróć obraz o 90 stopni w lewo","Rotate the image 90 degrees to the right":"Obróć obraz o 90 stopni w prawo","Show next media file in folder":"Pokaż następny plik w katalogu","Show previous media file in folder":"Pokaż poprzedni plik w katalogu","Show the image at its normal size":"Pokaż obraz w normalnym rozmiarze","Shrink the image":"Pomniejsz obraz"},de={},ce={"%{ displayIndex } of %{ availableMediaFiles }":"%{ displayIndex } z %{ availableMediaFiles }","Download currently viewed file":"Stiahnuť zobrazený súbor","Failed to load media file":"Načítanie súboru zlyhalo","Loading media file":"Načítanie súboru","Media file %{ displayIndex } of %{ availableMediaFiles }":"Súbor média %{ displayIndex } z %{ availableMediaFiles }","Show next media file in folder":"Zobrazí ďalšie médium v priečinku","Show previous media file in folder":"Zobrazí predošlé médium v priečinku"},me={"%{ displayIndex } of %{ availableMediaFiles }":"%{ displayIndex } nga %{ availableMediaFiles } gjithsej","Download currently viewed file":"Shkarko kartelën e parë tani","Enlarge the image":"Zmadhoje figurën","Enter full screen mode":"Kalo nën mënyrën “Sa krejt ekrani”","Exit full screen mode":"Dil nga mënyra “Sa krejt ekrani”","Failed to load media file":"S’u arrit të ngarkohet kartelë media","Loading media file":"Po ngarkohet kartelë media","Media file %{ displayIndex } of %{ availableMediaFiles }":"Kartelë media %{ displayIndex } nga %{ availableMediaFiles } gjithsej",Preview:"Paraparje","Preview for %{currentMediumName}":"Paraparje për %{currentMediumName}","Rotate the image 90 degrees to the left":"Rrotulloje figurën me 90 gradë majtas","Rotate the image 90 degrees to the right":"Rrotulloje figurën me 90 gradë djathtas","Show next media file in folder":"Shfaq kartelën pasuese media në dosje","Show previous media file in folder":"Shfaq kartelën e mëparshme media në dosje","Show the image at its normal size":"Shfaqe figurën në madhësinë e vet normale","Shrink the image":"Tkurre figurën"},ue={"%{ displayIndex } of %{ availableMediaFiles }":"%{ displayIndex } / %{ availableMediaFiles }","Download currently viewed file":"Şu anda görüntülenen dosyayı indir","Failed to load media file":"Medya dosyasını yükleme başarısız","Loading media file":"Medya dosyası yükleniyor","Media file %{ displayIndex } of %{ availableMediaFiles }":"Medya dosyası %{ displayIndex } / %{ availableMediaFiles }",Preview:"Önizle","Preview for %{currentMediumName}":"%{currentMediumName} için önizleme","Show next media file in folder":"Sonraki medya dosyasını klasörde göster","Show previous media file in folder":"Önceki medya dosyasını klasörde göster"},pe={ar:Y,bg:ee,cs:ie,de:ae,es:te,fr:oe,gl:ne,he:re,it:le,pl:se,ru:de,sk:ce,sq:me,tr:ue},he=x({name:"MediaControls",props:{files:{type:Array,required:!0},activeIndex:{type:Number,required:!0},isFullScreenModeActivated:{type:Boolean,default:!1},isFolderLoading:{type:Boolean,default:!1},isImage:{type:Boolean,default:!1},currentImageZoom:{type:Number,default:1},currentImageRotation:{type:Number,default:0}},emits:["setRotation","setZoom","toggleFullScreen","toggleNext","togglePrevious"],setup(e,{emit:i}){const{$gettext:a}=j(),n=I(()=>`${(e.currentImageZoom*100).toFixed(0)}%`),l=I(()=>a("%{ displayIndex } of %{ availableMediaFiles }",{displayIndex:(e.activeIndex+1).toString(),availableMediaFiles:e.files.length.toString()})),y=I(()=>a("Media file %{ displayIndex } of %{ availableMediaFiles }",{displayIndex:(e.activeIndex+1).toString(),availableMediaFiles:e.files.length.toString()})),r=(k,C)=>Math.round(k*C*20)/20,d=()=>{i("setZoom",Math.max(.1,r(e.currentImageZoom,.8)))},s=()=>{const k=r(9,1.25);i("setZoom",Math.min(r(e.currentImageZoom,1.25),k))},F=()=>{i("setRotation",e.currentImageRotation===-270?0:e.currentImageRotation-90)},M=()=>{i("setRotation",e.currentImageRotation===270?0:e.currentImageRotation+90)};return{currentZoomDisplayValue:n,screenreaderFileCount:y,ariaHiddenFileCount:l,enterFullScreenDescription:a("Enter full screen mode"),exitFullScreenDescription:a("Exit full screen mode"),imageShrinkDescription:a("Shrink the image"),imageZoomDescription:a("Enlarge the image"),imageOriginalSizeDescription:a("Show the image at its normal size"),imageRotateLeftDescription:a("Rotate the image 90 degrees to the left"),imageRotateRightDescription:a("Rotate the image 90 degrees to the right"),previousDescription:a("Show previous media file in folder"),nextDescription:a("Show next media file in folder"),imageShrink:d,imageZoom:s,imageRotateLeft:F,imageRotateRight:M}}});const fe={class:"oc-background-brand oc-p-s oc-width-large oc-flex oc-flex-middle oc-flex-center oc-flex-around preview-controls-action-bar"},ge={key:0,class:"oc-m-rm preview-controls-action-count"},ve=["textContent"],ye=["textContent"],Fe={class:"oc-flex"},be={key:1,class:"oc-flex oc-flex-middle"},we={class:"oc-flex"},Ie=["textContent"],Me={class:"oc-ml-m"};function ke(e,i,a,n,l,y){const r=f("oc-icon"),d=f("oc-button"),s=V("oc-tooltip");return o(),w("div",{class:T(["oc-position-medium oc-position-bottom-center preview-details",{lightbox:e.isFullScreenModeActivated}])},[v("div",fe,[b((o(),m(d,{class:"preview-controls-previous",appearance:"raw-inverse",variation:"brand","aria-label":e.previousDescription,onClick:i[0]||(i[0]=F=>e.$emit("togglePrevious"))},{default:g(()=>[h(r,{size:"large",name:"arrow-drop-left",variation:"inherit"})]),_:1},8,["aria-label"])),[[s,e.previousDescription]]),u(),e.isFolderLoading?P("",!0):(o(),w("p",ge,[v("span",{"aria-hidden":"true",textContent:$(e.ariaHiddenFileCount)},null,8,ve),u(),v("span",{class:"oc-invisible-sr",textContent:$(e.screenreaderFileCount)},null,8,ye)])),u(),b((o(),m(d,{class:"preview-controls-next",appearance:"raw-inverse",variation:"brand","aria-label":e.nextDescription,onClick:i[1]||(i[1]=F=>e.$emit("toggleNext"))},{default:g(()=>[h(r,{size:"large",name:"arrow-drop-right",variation:"inherit"})]),_:1},8,["aria-label"])),[[s,e.nextDescription]]),u(),v("div",Fe,[b((o(),m(d,{class:"preview-controls-fullscreen",appearance:"raw-inverse",variation:"brand","aria-label":e.isFullScreenModeActivated?e.exitFullScreenDescription:e.enterFullScreenDescription,onClick:i[2]||(i[2]=F=>e.$emit("toggleFullScreen"))},{default:g(()=>[h(r,{"fill-type":"line",name:e.isFullScreenModeActivated?"fullscreen-exit":"fullscreen",variation:"inherit"},null,8,["name"])]),_:1},8,["aria-label"])),[[s,e.isFullScreenModeActivated?e.exitFullScreenDescription:e.enterFullScreenDescription]])]),u(),e.isImage?(o(),w("div",be,[v("div",we,[b((o(),m(d,{class:"preview-controls-image-shrink",appearance:"raw-inverse",variation:"brand","aria-label":e.imageShrinkDescription,onClick:e.imageShrink},{default:g(()=>[h(r,{"fill-type":"line",name:"checkbox-indeterminate",variation:"inherit"})]),_:1},8,["aria-label","onClick"])),[[s,e.imageShrinkDescription]]),u(),b((o(),m(d,{class:"preview-controls-image-original-size oc-ml-s oc-mr-s",appearance:"raw-inverse",variation:"brand","aria-label":e.imageOriginalSizeDescription,onClick:i[3]||(i[3]=F=>e.$emit("setZoom",1))},{default:g(()=>[v("span",{textContent:$(e.currentZoomDisplayValue)},null,8,Ie)]),_:1},8,["aria-label"])),[[s,e.imageOriginalSizeDescription]]),u(),b((o(),m(d,{class:"preview-controls-image-zoom",appearance:"raw-inverse",variation:"brand","aria-label":e.imageZoomDescription,onClick:e.imageZoom},{default:g(()=>[h(r,{"fill-type":"line",name:"add-box",variation:"inherit"})]),_:1},8,["aria-label","onClick"])),[[s,e.imageZoomDescription]])]),u(),v("div",Me,[b((o(),m(d,{class:"preview-controls-rotate-left",appearance:"raw-inverse",variation:"brand","aria-label":e.imageRotateLeftDescription,onClick:e.imageRotateLeft},{default:g(()=>[h(r,{"fill-type":"line",name:"anticlockwise",variation:"inherit"})]),_:1},8,["aria-label","onClick"])),[[s,e.imageRotateLeftDescription]]),u(),b((o(),m(d,{class:"preview-controls-rotate-right",appearance:"raw-inverse",variation:"brand","aria-label":e.imageRotateRightDescription,onClick:e.imageRotateRight},{default:g(()=>[h(r,{"fill-type":"line",name:"clockwise",variation:"inherit"})]),_:1},8,["aria-label","onClick"])),[[s,e.imageRotateRightDescription]])])])):P("",!0)])],2)}const Ce=z(he,[["render",ke],["__scopeId","data-v-06e5d124"]]),Se=x({name:"MediaAudio",props:{file:{type:Object,required:!0},isAutoPlayEnabled:{type:Boolean,default:!0}}}),xe=["autoplay"],ze=["src","type"];function Ae(e,i,a,n,l,y){return o(),w("audio",{key:`media-audio-${e.file.id}`,controls:"",preload:"preload",autoplay:e.isAutoPlayEnabled},[v("source",{src:e.file.url,type:e.file.mimeType},null,8,ze)],8,xe)}const $e=z(Se,[["render",Ae]]),Pe=x({name:"MediaImage",props:{file:{type:Object,required:!0},currentImageZoom:{type:Number,required:!0},currentImageRotation:{type:Number,required:!0}}}),De=["src","alt","data-id"];function Re(e,i,a,n,l,y){return o(),w("img",{key:`media-image-${e.file.id}`,src:e.file.url,alt:e.file.name,"data-id":e.file.id,style:B(`zoom: ${e.currentImageZoom};transform: rotate(${e.currentImageRotation}deg)`)},null,12,De)}const Ee=z(Pe,[["render",Re]]),Le=x({name:"MediaVideo",props:{file:{type:Object,required:!0},isAutoPlayEnabled:{type:Boolean,default:!0}}}),Te=["autoplay"],Ne=["src","type"];function Ze(e,i,a,n,l,y){return o(),w("video",{key:`media-video-${e.file.id}`,controls:"",preload:"preload",autoplay:e.isAutoPlayEnabled},[v("source",{src:e.file.url,type:e.file.mimeType},null,8,Ne)],8,Te)}const _e=z(Le,[["render",Ze]]),N="preview",Z=()=>{var e;return["audio/flac","audio/mpeg","audio/ogg","audio/wav","audio/x-flac","audio/x-wav","image/gif","image/jpeg","image/png","video/mp4","video/webm",...((e=window.__$store)==null?void 0:e.getters.extensionConfigByAppId(N).mimeTypes)||[]]},je=x({name:"Preview",components:{AppTopBar:J,MediaControls:Ce,MediaAudio:$e,MediaImage:Ee,MediaVideo:_e},setup(){const e=H(),i=W(),a=O({applicationId:"preview"}),n=K("contextRouteQuery"),l=R(),y=R([]),r=I(()=>{var c;return t(n)&&(c=t(n)["sort-by"])!=null?c:"name"}),d=I(()=>{var c;return t(n)?(c=t(n)["sort-dir"])!=null?c:"asc":"desc"}),{activeFiles:s,currentFileContext:F}=a,M=R(!1),k=()=>{const c=!t(M);M.value=c,c?document.documentElement.requestFullscreen&&document.documentElement.requestFullscreen():document.exitFullscreen&&document.exitFullscreen()},C=I(()=>{if(!t(s))return[];const c=t(s).filter(D=>{var L;return Z().includes((L=D.mimeType)==null?void 0:L.toLowerCase())});return Q(c,[{name:t(r)}],t(r),t(d))}),S=I(()=>t(C)[t(l)]),A=I(()=>t(y).find(c=>c.id===t(S).id)),p=()=>{const{params:c,query:D}=G(t(t(F).space),t(S));e.replace({...t(i),params:{...t(i).params,...c},query:{...t(i).query,...D}})};return{...a,...X(),cachedFiles:y,filteredFiles:C,activeFilteredFile:S,activeIndex:l,activeMediaFileCached:A,isFullScreenModeActivated:M,toggleFullscreenMode:k,updateLocalHistory:p}},data(){return{isFileContentLoading:!0,isFileContentError:!1,isAutoPlayEnabled:!0,toPreloadImageIds:[],currentImageZoom:1,currentImageRotation:0,preloadImageCount:10}},computed:{pageTitle(){var e;return this.$gettext("Preview for %{currentMediumName}",{currentMediumName:(e=this.activeFilteredFile)==null?void 0:e.name})},thumbDimensions(){switch(!0){case window.innerWidth<=1024:return 1024;case window.innerWidth<=1280:return 1280;case window.innerWidth<=1920:return 1920;case window.innerWidth<=2160:return 2160;default:return 3840}},isActiveFileTypeImage(){return!this.isActiveFileTypeAudio&&!this.isActiveFileTypeVideo},isActiveFileTypeAudio(){return this.isFileTypeAudio(this.activeFilteredFile)},isActiveFileTypeVideo(){return this.isFileTypeVideo(this.activeFilteredFile)}},watch:{activeIndex(e,i){e!==i&&(this.loadMedium(),this.preloadImages()),i!==null&&(this.isAutoPlayEnabled=!1),this.currentImageZoom=1,this.currentImageRotation=0}},async mounted(){window.addEventListener("popstate",this.handleLocalHistoryEvent),document.addEventListener("fullscreenchange",this.handleFullScreenChangeEvent),await this.loadFolderForFileContext(this.currentFileContext),this.setActiveFile(t(this.currentFileContext.driveAliasAndItem)),this.$refs.preview.focus()},beforeUnmount(){window.removeEventListener("popstate",this.handleLocalHistoryEvent),document.removeEventListener("fullscreenchange",this.handleFullScreenChangeEvent),this.cachedFiles.forEach(e=>{this.revokeUrl(e.url)})},methods:{setActiveFile(e){var i;for(let a=0;a<this.filteredFiles.length;a++)if(((i=t(this.currentFileContext.space))==null?void 0:i.getDriveAliasAndItem(this.filteredFiles[a]))===e){this.activeIndex=a;return}this.isFileContentLoading=!1,this.isFileContentError=!0},handleLocalHistoryEvent(){const e=this.$router.resolve(document.location);this.setActiveFile(U(e.params.driveAliasAndItem))},handleFullScreenChangeEvent(){document.fullscreenElement===null&&(this.isFullScreenModeActivated=!1)},loadMedium(){if(this.isFileContentLoading=!0,this.activeMediaFileCached){setTimeout(()=>{this.isFileContentLoading=!1},50);return}this.loadActiveFileIntoCache()},async loadActiveFileIntoCache(){try{const e=!this.isActiveFileTypeImage;let i;e?i=await this.getUrlForResource(t(this.currentFileContext.space),this.activeFilteredFile):i=await this.loadPreview(this.activeFilteredFile),this.addPreviewToCache(this.activeFilteredFile,i),this.isFileContentLoading=!1,this.isFileContentError=!1}catch(e){this.isFileContentLoading=!1,this.isFileContentError=!0,console.error(e)}},triggerActiveFileDownload(){if(!this.isFileContentLoading)return this.downloadFile(this.activeFilteredFile)},next(){if(!this.isFileContentLoading){if(this.isFileContentError=!1,this.activeIndex+1>=this.filteredFiles.length){this.activeIndex=0,this.updateLocalHistory();return}this.activeIndex++,this.updateLocalHistory()}},prev(){if(!this.isFileContentLoading){if(this.isFileContentError=!1,this.activeIndex===0){this.activeIndex=this.filteredFiles.length-1,this.updateLocalHistory();return}this.activeIndex--,this.updateLocalHistory()}},isFileTypeImage(e){return!this.isFileTypeAudio(e)&&!this.isFileTypeVideo(e)},isFileTypeAudio(e){return e.mimeType.toLowerCase().startsWith("audio")},isFileTypeVideo(e){return e.mimeType.toLowerCase().startsWith("video")},addPreviewToCache(e,i){this.cachedFiles.push({id:e.id,name:e.name,url:i,ext:e.extension,mimeType:e.mimeType,isVideo:this.isFileTypeVideo(e),isImage:this.isFileTypeImage(e),isAudio:this.isFileTypeAudio(e)})},loadPreview(e){return this.$previewService.loadPreview({space:t(this.currentFileContext.space),resource:e,dimensions:[this.thumbDimensions,this.thumbDimensions]})},preloadImages(){const e=a=>{this.toPreloadImageIds.push(a.id),this.loadPreview(a).then(n=>{this.addPreviewToCache(a,n)}).catch(n=>{console.error(n),this.toPreloadImageIds=this.toPreloadImageIds.filter(l=>l!==a.id)})},i=a=>{let n=((this.activeIndex+a)%this.filteredFiles.length+this.filteredFiles.length)%this.filteredFiles.length;const l=this.filteredFiles[n];!this.isFileTypeImage(l)||this.toPreloadImageIds.includes(l.id)||e(l)};for(let a=1;a<=this.preloadImageCount;a++)i(a);for(let a=-1;a>=this.preloadImageCount*-1;a--)i(a)}}});const Ve=["textContent"],Be={key:0,class:"oc-position-center"};function qe(e,i,a,n,l,y){var A;const r=f("oc-icon"),d=f("oc-button"),s=f("app-top-bar"),F=f("oc-spinner"),M=f("media-image"),k=f("media-video"),C=f("media-audio"),S=f("media-controls");return o(),w("main",{id:"preview",ref:"preview",tabindex:"-1",onKeydown:[i[2]||(i[2]=E((...p)=>e.prev&&e.prev(...p),["left"])),i[3]||(i[3]=E((...p)=>e.next&&e.next(...p),["right"])),i[4]||(i[4]=E((...p)=>e.closeApp&&e.closeApp(...p),["esc"]))]},[v("h1",{class:"oc-invisible-sr",textContent:$(e.pageTitle)},null,8,Ve),u(),h(s,{resource:e.activeFilteredFile,onClose:e.closeApp},{right:g(()=>[e.isFileContentError?P("",!0):(o(),m(d,{key:0,class:"preview-download",size:"small","aria-label":e.$gettext("Download currently viewed file"),onClick:e.triggerActiveFileDownload},{default:g(()=>[h(r,{size:"small",name:"file-download"})]),_:1},8,["aria-label","onClick"]))]),_:1},8,["resource","onClose"]),u(),e.isFolderLoading||e.isFileContentLoading?(o(),w("div",Be,[h(F,{"aria-label":e.$gettext("Loading media file"),size:"xlarge"},null,8,["aria-label"])])):e.isFileContentError?(o(),m(r,{key:1,name:"file-damage",variation:"danger",size:"xlarge",class:"oc-position-center","accessible-label":e.$gettext("Failed to load media file")},null,8,["accessible-label"])):b((o(),w("div",{key:2,class:T(["oc-width-1-1 oc-flex oc-flex-center oc-flex-middle oc-p-s oc-box-shadow-medium preview-player",{lightbox:e.isFullScreenModeActivated}])},[e.activeMediaFileCached.isImage?(o(),m(M,{key:0,file:e.activeMediaFileCached,"current-image-rotation":e.currentImageRotation,"current-image-zoom":e.currentImageZoom},null,8,["file","current-image-rotation","current-image-zoom"])):e.activeMediaFileCached.isVideo?(o(),m(k,{key:1,file:e.activeMediaFileCached,"is-auto-play-enabled":e.isAutoPlayEnabled},null,8,["file","is-auto-play-enabled"])):e.activeMediaFileCached.isAudio?(o(),m(C,{key:2,file:e.activeMediaFileCached,"is-auto-play-enabled":e.isAutoPlayEnabled},null,8,["file","is-auto-play-enabled"])):P("",!0)],2)),[[q,e.activeMediaFileCached]]),u(),h(S,{files:e.filteredFiles,"active-index":e.activeIndex,"is-full-screen-mode-activated":e.isFullScreenModeActivated,"is-folder-loading":e.isFolderLoading,"is-image":(A=e.activeMediaFileCached)==null?void 0:A.isImage,"current-image-rotation":e.currentImageRotation,"current-image-zoom":e.currentImageZoom,onSetRotation:i[0]||(i[0]=p=>e.currentImageRotation=p),onSetZoom:i[1]||(i[1]=p=>e.currentImageZoom=p),onToggleFullScreen:e.toggleFullscreenMode,onTogglePrevious:e.prev,onToggleNext:e.next},null,8,["files","active-index","is-full-screen-mode-activated","is-folder-loading","is-image","current-image-rotation","current-image-zoom","onToggleFullScreen","onTogglePrevious","onToggleNext"])],544)}const Oe=z(je,[["render",qe],["__scopeId","data-v-936f4667"]]),He=Object.freeze(Object.defineProperty({__proto__:null,appId:N,default:Oe,mimeTypes:Z},Symbol.toStringTag,{value:"Module"})),{default:We,mimeTypes:_,appId:Ke}=He;const Ue=[{path:"/:driveAliasAndItem(.*)?",component:We,name:"media",meta:{authContext:"hybrid",title:"Preview",patchCleanPath:!0}}],Ge="preview-media",Qe={name:"Preview",id:Ke,icon:"eye",extensions:_().map(e=>({canBeDefault:!0,mimeType:e,routeName:Ge,label:"Preview"}))},ri={appInfo:Qe,routes:Ue,translations:pe,mimeTypes:_};export{ri as default};
